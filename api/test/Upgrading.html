<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Factory Muffin</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Enables The Rapid Creation Of Objects For Testing" />
    <meta name="author" content="Factory Muffin">
        <link rel="icon" href="img/favicon-blue.png" type="image/x-icon">
        <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>

    <!-- LESS -->
            <link rel="stylesheet" href="css/daux-blue.min.css">
    </head>
<body>
            <!-- Docs -->
                    <a href="https://github.com/thephpleague/factory-muffin" target="_blank" id="github-ribbon" class="hidden-print"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
                <div class="container-fluid fluid-height wrapper">
            <div class="navbar navbar-fixed-top hidden-print">
                <div class="container-fluid">
                    <a class="brand navbar-brand pull-left" href="index.html">Factory Muffin</a>
                    <p class="navbar-text pull-right">
                        Generated by <a href="http://daux.io">Daux.io</a>
                    </p>
                </div>
            </div>

            <div class="row columns content">
                <div class="left-column article-tree col-sm-3 hidden-print">
                    <!-- For Mobile -->
                    <div class="responsive-collapse">
                        <button type="button" class="btn btn-sidebar" id="menu-spinner-button">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                    <div id="sub-nav-collapse" class="sub-nav-collapse">
                        <!-- Navigation -->
                        <ul class="nav nav-list"><li><a href="./Introduction.html">Introduction</a></li><li><a href="./Usage_Docs.html">Usage Docs</a></li><li><a href="./Upgrading.html">Upgrading</a></li><li><a href="./Contributing.html">Contributing</a></li></ul>                                                    <div class="well well-sidebar">
                                <!-- Links -->
                                                                    <a href="https://github.com/thephpleague/factory-muffin" target="_blank">GitHub Repo</a><br>
                                                                    <a href="https://github.com/thephpleague/factory-muffin/issues" target="_blank">Help/Support/Bugs</a><br>
                                                                    <a href="https://github.com/GrahamCampbell" target="_blank">Graham Campbell</a><br>
                                                                    <a href="https://github.com/scottrobertson" target="_blank">Scott Robertson</a><br>
                                                                                                <!-- Twitter -->
                                                                    <div class="twitter">
                                                <hr/>
                                        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=thephpleague&amp;show_count=false"></iframe>
                                    </div>
                                                                    <div class="twitter">
                                                <hr/>
                                        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=grahamjcampbell&amp;show_count=false"></iframe>
                                    </div>
                                                                    <div class="twitter">
                                                <hr/>
                                        <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=scottymeuk&amp;show_count=false"></iframe>
                                    </div>
                                                            </div>
                                            </div>
                </div>
                <div class="right-column  content-area col-sm-9">
                    <div class="content-page">
                        <article>
                                                            <div class="page-header sub-header clearfix">
                                    <h1>Upgrading                                                                            </h1>
                                        <span style="float: left; font-size: 10px; color: gray;">
                                            Sunday, August 10, 2014                                        </span>
                                        <span style="float: right; font-size: 10px; color: gray;">
                                            11:50 PM                                        </span>
                                </div>
                                                        <p>Welcome to the upgrade guide for Factory Muffin. We've tried to cover all changes from 1.4 through to the current release. If we've missed anything, feel free to create an issue, or send a pull request. From 2.0, we are following the PSR-2 coding standard, and semantic versioning, so there will be no BC breaks until 3.0 other than essential fixes, and any changes will be documented here.</p>
<h2>Upgrading from 1.6.x to 2.0.x</h2>
<h3>Introduction</h3>
<p>Version 2.0 marks a major file milestone in this project, under the new name of "Factory Muffin". We see a large number of improvements and some breaking changes. Within this section of the upgrading guide, you will see "the <code>xyz</code> function can be called". You should assume that these functions should be called statically on the <code>League\FactoryMuffin\Facade</code> class.</p>
<h3>Class Name Changes</h3>
<p>Every class has moved, so here's a summary of the changes:</p>
<ul>
<li>The root namespace has been moved from <code>Zizaco\FactoryMuff</code> to <code>League\FactoryMuffin</code>. You should now access the facade using <code>Zizaco\FactoryMuff\Facade::fooBar()</code>.</li>
<li>Many generator (kind) classes have been removed in favour of the faker alternatives. Those remaining can be found under the <code>Zizaco\FactoryMuff\Generators</code> namespace.</li>
<li>There are many more exceptions, and the names of the existing exceptions have changed. The exceptions can be found under the <code>Zizaco\FactoryMuff\Exception</code> namespace.</li>
</ul>
<p>A detailed list of every change with FQCNs is listed below:</p>
<ul>
<li>Moved: <code>Zizaco\FactoryMuff\FactoryMuff</code> => <code>League\FactoryMuffin\Factory</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Facade\FactoryMuff</code> => <code>League\FactoryMuffin\Facade</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\SaveException</code> => <code>League\FactoryMuffin\Exceptions\SaveFailedException</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\NoDefinedFactoryException</code> => <code>League\FactoryMuffin\Exceptions\NoDefinedFactoryException</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Kind</code> => <code>League\FactoryMuffin\Generators\Base</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Kind\Call</code> => <code>League\FactoryMuffin\Generators\Call</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Kind\Closure</code> => <code>League\FactoryMuffin\Generators\Closure</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Kind\Factory</code> => <code>League\FactoryMuffin\Generators\Factory</code></li>
<li>Moved: <code>Zizaco\FactoryMuff\Kind\Generic</code> => <code>League\FactoryMuffin\Generators\Generic</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\DeleteFailedException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\DeleteMethodNotFoundException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\DeletingFailedException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\DirectoryNotFoundException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\MethodNotFoundException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\ModelException</code></li>
<li>Added: <code>League\FactoryMuffin\Exceptions\SaveMethodNotFoundException</code></li>
<li>Removed: <code>Zizaco\FactoryMuff\Kind\Date</code></li>
<li>Removed: <code>Zizaco\FactoryMuff\Kind\Integer</code></li>
<li>Removed: <code>Zizaco\FactoryMuff\Kind\Name</code></li>
<li>Removed: <code>Zizaco\FactoryMuff\Kind\String</code></li>
<li>Removed: <code>Zizaco\FactoryMuff\Kind\Text</code></li>
</ul>
<p>It also should be noted that we've moved from PSR-0 to PSR-4 for autoloading.</p>
<h3>Facade Changes</h3>
<p>Under it's new name, the facade class now uses <code>__callStatic</code> to dynamically call the underlying factory instance. Also, note that all public methods that would have returned void, return the factory instance in order to support method chaining.</p>
<h3>Factory Definitions</h3>
<p>Having a public static factory property is no longer supported. You must use the <code>define</code> function introduced in the 1.5.x series. You may call it like this: <code>League\FactoryMuffin\Facade::define('Fully\Qualifed\ModelName', array('foo' =&gt; 'bar'))</code>. We have provided a nifty way for you to do this in your tests. PHPUnit provides a <code>setupBeforeClass</code> function. Within that function you can call <code>League\FactoryMuffin\Facade::loadFactories(__DIR__ . '/factories');</code>, and it will include all files in the factories folder. Within those php files, you can put your definitions (all your code that calls the define function). The <code>loadFactories</code> function will throw a <code>League\FactoryMuffin\Exceptions\DirectoryNotFoundException</code> exception if the directory you're loading is not found. A full example is included in the readme.</p>
<h3>Generator (Kind) Changes</h3>
<p>We now refer to what was previously the kind classes, as generator classes. We've removed some of these in favour of the faker alternatives. We currently provide the following generators: <code>Call</code>, <code>Closure</code>, <code>Factory</code>, and <code>Generic</code>. The call, closure, and factory generators have not changed significantly since previous versions, and the generic generator still provides access to the faker generators. The closure generator will now pass the instance of your model into your closure as the first parameter too.</p>
<p>There are two syntax changes to watch out for:</p>
<ul>
<li>You can now use a <code>;</code> to send multiple arguments to the generators.</li>
<li>Unique and optional attributes are now supported by prefixing the definition with <code>unique:</code> or <code>optional:</code>.</li>
</ul>
<p>The removed generators are <code>Date</code>, <code>Integer</code>, <code>Name</code>, <code>String</code>, and <code>Text</code>, however, these are still callable as they are available through the generic generator using faker. Here are some possible changes you will need to make:</p>
<ul>
<li>Instead of using <code>integer|8</code>, you can use <code>randomNumber|8</code>.</li>
<li>Instead of using <code>string</code>, you can use <code>sentence</code>, or <code>word</code>.</li>
<li>Instead of using <code>name</code>, you can use things like <code>firstNameMale</code>.</li>
<li><code>date</code> and <code>text</code> can be used in the same way you were using them before.</li>
</ul>
<p>It should be noted that we are using faker 1.4 which is a change since the previous release. We've made a more strict version requirement to avoid potential BC breaks caused by faker.</p>
<h3>Creating And Seeding</h3>
<p>The <code>create</code> function can be called in the same way, but has internal improvements. Now, it will also save anything you generate with the <code>Factory</code> generator too. We now have a new function called <code>seed</code>, which accepts an additional argument at the start which is the number of models to generate in the process. The <code>seed</code> function will effectively be calling the <code>create</code> function over and over. It should be noted that you can set a custom save function before you get going with the <code>setSaveMethod</code> function. Also, a reminder that the <code>instance</code> function is still available if you don't want database persistence.</p>
<p>You may encounter the following exceptions:</p>
<ul>
<li><code>League\FactoryMuffin\Exceptions\NoDefinedFactoryException</code> will be thrown if you try to create a model and you haven't defined a factory definition for it earlier.</li>
<li><code>League\FactoryMuffin\Exceptions\SaveFailedException</code> will be thrown if the save function on your model returns false.</li>
<li><code>League\FactoryMuffin\Exceptions\SaveMethodNotFoundException</code> will be thrown if the save function on your model does not exist.</li>
<li>Any other exception thrown by your model while trying to create or save it.</li>
</ul>
<p>There are 2 other helper functions available. You may call <code>saved</code> to return an array of all the saved objects. You may call <code>isSaved</code> with an instance of a model to check if it's saved.</p>
<h3>Deleting</h3>
<p>You can now delete all your saved models with the <code>deleteSaved</code> function. It should be noted that you can set a custom delete function before you get going with the <code>setDeleteMethod</code> function.</p>
<p>If one or more models cannot be deleted, a <code>League\FactoryMuffin\Exceptions\DeletingFailedException</code> will be raised after we have attempted to delete all the saved models. You may access each underlying exception, in the order they were thrown during the whole process, with the <code>getExceptions</code> function which will return an array of exceptions. You may encounter the following exceptions:</p>
<ul>
<li><code>League\FactoryMuffin\Exceptions\DeleteFailedException</code> will be thrown if the delete function on your model returns false.</li>
<li><code>League\FactoryMuffin\Exceptions\DeleteMethodNotFoundException</code> will be thrown if the delete function on your model does not exist.</li>
<li>Any other exception thrown by your model while trying to delete it.</li>
</ul>
<p>It's recommended that you call the <code>deleteSaved</code> function from PHPUnit's <code>tearDownAfterClass</code> function. A full example is included in the readme.</p>
<h3>Exceptions</h3>
<p>The exceptions have been completely overhauled. Each exception is documented with the documentation for the functions that throw them.</p>
<p>You can see a diagram showing the exception hierarchy here:</p>
<p><img alt="diagram" style="width: 100%" src="https://cloud.githubusercontent.com/assets/2829600/3790579/8fc52572-1b0d-11e4-96b1-7f0eac0dc10d.png"></p>
<h3>Other BC Breaks</h3>
<p>The <code>attributesFor</code> function no longer accepts a class name as the first argument, and the <code>generateAttr</code> function no longer accepts a class name as a second argument. Please pass an actual model instance to both functions instead.</p>
<p>We now require php 5.3.3 as a minimum version. This is an increase on our previous requirement of php 5.3.0.</p>
<h3>Installing This Version</h3>
<p>In your composer.json, add:</p>
<pre><code class="language-json">{
    "require-dev": {
        "league/factory-muffin": "2.0.*"
    }
}</code></pre>
<h2>Upgrading from 1.5.x to 1.6.x</h2>
<h3>Faker Usage</h3>
<ul>
<li>We now use the faker package, so our <code>Zizaco\FactoryMuff\Wordlist</code> class has been removed. All your previous definitions should still work in as close to the same way as possible, but watch out for any minor differences. With the addition of the faker library, far more definitions are now possible since any definitions not natively provided by us, fall back to the faker package. Also, it should be noted you may use closures now to generate completely custom attributes. The new classes can be found under the <code>Zizaco\FactoryMuff\Kind</code> namespace.</li>
</ul>
<h3>Installing This Version</h3>
<p>In your composer.json, add:</p>
<pre><code class="language-json">{
    "require-dev": {
        "league/factory-muffin": "1.6.*"
    }
}</code></pre>
<h2>Upgrading from 1.4.x to 1.5.x</h2>
<h3>Exceptions</h3>
<p>We've added some exceptions for certain events:</p>
<ul>
<li>The <code>Zizaco\FactoryMuff\SaveException</code> will now be thrown on model creation if the save function returns false.</li>
<li>The <code>Zizaco\FactoryMuff\NoDefinedFactoryException</code> will now be thrown if you attempt to generate attributes for an model that has no defined factory. Previously, php would raise a fatal error.</li>
</ul>
<h3>Factory Definitions</h3>
<p>Instead of having a <code>public static $factory = array('foo' =&gt; 'bar')</code> property on your model, you should call <code>Zizaco\FactoryMuff\Facade\FactoryMuff::define('Fully\Qualifed\ModelName', array('foo' =&gt; 'bar'))</code> to define your model's factory. Note that the property on the model is still supported for now, but is deprecated, and will be removed in 2.0.</p>
<h3>Installing This Version</h3>
<p>In your composer.json, add:</p>
<pre><code class="language-json">{
    "require-dev": {
        "league/factory-muffin": "1.5.*"
    }
}</code></pre>                                                    </article>
                    </div>
                </div>
            </div>
        </div>
    


    <!-- hightlight.js -->
    <script src="js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Navigation -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
    if (typeof jQuery == 'undefined')
        document.write(unescape("%3Cscript src='js/jquery-1.11.0.min.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
        <script src="js/bootstrap.min.js"></script>
    <script src="js/custom.js"></script>
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</body>
</html>
